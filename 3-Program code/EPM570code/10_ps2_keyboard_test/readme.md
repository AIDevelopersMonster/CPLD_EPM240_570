# Проект: PS/2 клавиатура → UART (CPLD EPM240/EPM570)

Проект для платы **EPM240 / EPM570 CPLD Development Board**, который подключает обычную PS/2 клавиатуру и отправляет нажатые клавиши по интерфейсу UART (TTL/RS232) в компьютер или другое устройство.

При нажатии клавиши на клавиатуре её PS/2 scan-код принимается CPLD, переводится в ASCII (латинские буквы A–Z) и отправляется в виде байта по UART. В терминале на ПК можно наблюдать символы в реальном времени.

---

## Структура проекта

Основные модули:

- **`ps2_key.v`** — верхний модуль проекта  
  Соединяет все блоки:
  - приём PS/2 (`ps2scan`),
  - генератор скорости UART (`speed_select`),
  - передатчик UART (`my_uart_tx`).

- **`ps2scan.v`** — приём PS/2 и преобразование в ASCII  
  - Считывает данные с линий `ps2k_clk` и `ps2k_data`.  
  - Собирает полный кадр PS/2 (старт + 8 бит + чётность + стоп).  
  - Обрабатывает спецкод `0xF0` (отпускание клавиши).  
  - Для простоты переводит только некоторые scan-коды в **ASCII латинских букв A–Z**.  
  - На выходе:
    - `ps2_byte` — ASCII-код символа,
    - `ps2_state` — флаг «новый символ готов».

- **`speed_select.v`** — генератор тактовой частоты для UART  
  - Делит системную частоту 50 МГц до тактовой частоты для UART (по умолчанию 9600 бод).  
  - Использует макросы:
    - `BPS_PARA` — полный период,
    - `BPS_PARA_2` — момент выборки бита (середина периода).  
  - На выходе формирует импульс `clk_bps`, который используется в `my_uart_tx`.

- **`my_uart_tx.v`** — UART-передатчик (TX)  
  - Принимает байт `rx_data` и сигнал `rx_int` (флаг «данные готовы»).  
  - Формирует стандартный UART-кадр:
    - стартовый бит (0),
    - 8 бит данных,
    - стоповый бит (1).  
  - Выдаёт последовательный сигнал на вывод `rs232_tx`.  
  - Сигнал `bps_start` запускает работу `speed_select`.

---

## Подключение

1. **Клавиатура:**
   - Подключите PS/2 клавиатуру к разъёму PS/2 на плате CPLD.
   - Линии:
     - `ps2k_clk` → PS/2 CLK,
     - `ps2k_data` → PS/2 DATA.

2. **UART:**
   - Вывод `rs232_tx` подключите:
     - либо к USB-UART адаптеру (TTL-уровни),
     - либо к RS232-кабелю через соответствующий преобразователь.

3. **Питание и тактирование:**
   - Плата должна работать от штатного источника питания.
   - Частота `clk` — 50 МГц (стандартный генератор на плате).

---

## Настройка терминала на ПК

Откройте любой терминал (Putty, RealTerm, TeraTerm и т.п.) и установите параметры порта:

- Скорость: **9600 бод** (по умолчанию в проекте)
- Биты данных: **8**
- Чётность: **нет (N)**
- Стоп-биты: **1**
- Управление потоком: **нет**

При нажатии на клавиши латинского алфавита (A–Z) в терминале будут появляться соответствующие символы.

---

## Как это работает по шагам

1. Клавиатура посылает scan-коды по интерфейсу PS/2.
2. Модуль `ps2scan` принимает сигнал, собирает 8-битный код и преобразует его в ASCII.
3. Флаг `ps2_state` сигнализирует, что новый символ готов.
4. Модуль `my_uart_tx` по сигналу `ps2_state` забирает байт и отправляет по UART.
5. Модуль `speed_select` задаёт временные интервалы (скорость передачи) через сигнал `clk_bps`.

---

## Ссылки

- Репозиторий с проектами для CPLD-платы:  
  **https://github.com/AIDevelopersMonster/CPLD_EPM240_570**

- Плейлист по FPGA / CPLD на YouTube:  
  **https://www.youtube.com/playlist?list=PLVoFIRfTAAI7-d_Yk6bNVnj4atUdMxvT5**
